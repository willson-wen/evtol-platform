"use strict";(()=>{var e={};e.id=838,e.ids=[838],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},12348:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>D,originalPathname:()=>v,patchFetch:()=>A,requestAsyncStorage:()=>f,routeModule:()=>S,serverHooks:()=>h,staticGenerationAsyncStorage:()=>w,staticGenerationBailout:()=>q});var r={};a.r(r),a.d(r,{GET:()=>g});var n=a(95419),i=a(69108),o=a(99678),d=a(78070),s=a(6521),u=a(22345),p=a(52055);a(88460),a(59441);var c=a(11185);let l=new c.Schema({content:{type:String,required:[!0,"请输入评论内容"]},author:{type:c.Schema.Types.ObjectId,ref:"User",required:!0},likes:[{type:c.Schema.Types.ObjectId,ref:"User"}],createdAt:{type:Date,default:Date.now}}),y=new c.Schema({title:{type:String,required:[!0,"请输入标题"]},content:{type:String,required:[!0,"请输入内容"]},type:{type:String,enum:["白皮书","新闻","研究报告","讨论"],required:[!0,"请选择文章类型"]},author:{type:c.Schema.Types.ObjectId,ref:"User",required:!0},company:{type:c.Schema.Types.ObjectId,ref:"Company"},tags:[String],coverImage:String,attachments:[{name:String,url:String}],views:{type:Number,default:0},likes:[{type:c.Schema.Types.ObjectId,ref:"User"}],comments:[l],status:{type:String,enum:["草稿","已发布","已删除"],default:"已发布"},createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}});y.pre("save",function(e){this.updatedAt=new Date,e()}),c.models.Post||(0,c.model)("Post",y);let m={create:async(e,t)=>(await (0,u.u)(),await e.create(t)),findById:async(e,t)=>(await (0,u.u)(),await e.findById(t)),find:async(e,t={},a={})=>(await (0,u.u)(),await e.find(t,null,a)),update:async(e,t,a)=>(await (0,u.u)(),await e.findByIdAndUpdate(t,a,{new:!0})),delete:async(e,t)=>(await (0,u.u)(),await e.findByIdAndDelete(t)),paginate:async(e,t={},a=1,r=10)=>{await (0,u.u)();let[n,i]=await Promise.all([e.find(t).skip((a-1)*r).limit(r),e.countDocuments(t)]);return{data:n,total:i,page:a,totalPages:Math.ceil(i/r)}}};async function g(){try{let e=await (0,s.hash)("test123456",12),t=await m.create(p.Z,{name:"测试用户",email:"test@example.com",password:e,role:"admin"});return d.Z.json({message:"测试用户创建成功",user:{id:t._id,name:t.name,email:t.email}})}catch(e){return console.error("创建测试用户失败:",e),d.Z.json({message:"创建测试用户失败"},{status:500})}}let S=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/setup/route",pathname:"/api/setup",filename:"route",bundlePath:"app/api/setup/route"},resolvedPagePath:"C:\\Users\\Lenovo\\Desktop\\低空网站原始\\app\\api\\setup\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:w,serverHooks:h,headerHooks:D,staticGenerationBailout:q}=S,v="/api/setup/route";function A(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:w})}},22345:(e,t,a)=>{a.d(t,{u:()=>d});var r=a(11185),n=a.n(r);let i=process.env.MONGODB_URI;if(!i)throw Error("请在环境变量中设置 MONGODB_URI");let o=!1;async function d(){if(o){console.log("已连接到 MongoDB");return}try{let e=await n().connect(i);o=1===e.connections[0].readyState,console.log("MongoDB 连接成功")}catch(e){throw console.error("MongoDB 连接失败:",e),e}}},88460:(e,t,a)=>{a.d(t,{Z:()=>i});var r=a(11185);let n=new r.Schema({name:{type:String,required:[!0,"公司名称是必填项"],unique:!0},description:{type:String,required:[!0,"公司描述是必填项"]},location:{type:String,required:[!0,"公司所在地是必填项"]},status:{type:String,enum:["研发中","测试中","适航认证进行中","已获认证","已投产"],default:"研发中"},foundedYear:{type:Number},website:{type:String},products:[{name:String,description:String,specifications:{range:String,speed:String,capacity:String,dimensions:String}}],createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}});n.pre("save",function(e){this.updatedAt=new Date,e()});let i=r.models.Company||(0,r.model)("Company",n)},59441:(e,t,a)=>{a.d(t,{Z:()=>i});var r=a(11185);let n=new r.Schema({title:{type:String,required:[!0,"职位名称是必填项"]},company:{type:String,required:[!0,"公司名称是必填项"]},location:{type:String,required:[!0,"工作地点是必填项"]},type:{type:String,enum:["全职","兼职","实习"],default:"全职"},salary:{type:String,required:[!0,"薪资范围是必填项"]},description:{type:String,required:[!0,"职位描述是必填项"]},requirements:[{type:String}],contact:{name:String,email:String,phone:String},postedBy:{type:r.Schema.Types.ObjectId,ref:"User",required:!0},status:{type:String,enum:["open","closed"],default:"open"},createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}});n.pre("save",function(e){this.updatedAt=new Date,e()});let i=r.models.Job||(0,r.model)("Job",n)},52055:(e,t,a)=>{a.d(t,{Z:()=>i});var r=a(11185);let n=new r.Schema({name:{type:String,required:[!0,"请输入用户名"]},email:{type:String,required:[!0,"请输入邮箱"],unique:!0,lowercase:!0,trim:!0},password:{type:String,required:[!0,"请输入密码"],minlength:[6,"密码至少6个字符"]},role:{type:String,enum:["user","admin"],default:"user"},avatar:{type:String,default:""},company:{type:String,default:""},position:{type:String,default:""},createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}});n.pre("save",function(e){this.updatedAt=new Date,e()});let i=r.models.User||(0,r.model)("User",n)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[638,206,521],()=>a(12348));module.exports=r})();