"use strict";(()=>{var e={};e.id=280,e.ids=[280],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13046:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>f,patchFetch:()=>S,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>y});var n={};r.r(n),r.d(n,{GET:()=>p});var o=r(95419),a=r(69108),i=r(99678),s=r(78070),u=r(22345),c=r(88460);async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("q");if(!r)return s.Z.json({error:"搜索关键词不能为空"},{status:400});await (0,u.u)();let n=RegExp(r,"i"),o=await c.Z.find({$or:[{name:n},{description:n},{"products.name":n},{"products.description":n}]}).select("name description location status");return s.Z.json(o)}catch(e){return console.error("搜索失败:",e),s.Z.json({error:"搜索失败"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/search/route",pathname:"/api/search",filename:"route",bundlePath:"app/api/search/route"},resolvedPagePath:"C:\\Users\\Lenovo\\Desktop\\低空网站原始\\app\\api\\search\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:g,serverHooks:m,headerHooks:h,staticGenerationBailout:y}=d,f="/api/search/route";function S(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:g})}},22345:(e,t,r)=>{r.d(t,{u:()=>s});var n=r(11185),o=r.n(n);let a=process.env.MONGODB_URI;if(!a)throw Error("请在环境变量中设置 MONGODB_URI");let i=!1;async function s(){if(i){console.log("已连接到 MongoDB");return}try{let e=await o().connect(a);i=1===e.connections[0].readyState,console.log("MongoDB 连接成功")}catch(e){throw console.error("MongoDB 连接失败:",e),e}}},88460:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(11185);let o=new n.Schema({name:{type:String,required:[!0,"公司名称是必填项"],unique:!0},description:{type:String,required:[!0,"公司描述是必填项"]},location:{type:String,required:[!0,"公司所在地是必填项"]},status:{type:String,enum:["研发中","测试中","适航认证进行中","已获认证","已投产"],default:"研发中"},foundedYear:{type:Number},website:{type:String},products:[{name:String,description:String,specifications:{range:String,speed:String,capacity:String,dimensions:String}}],createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}});o.pre("save",function(e){this.updatedAt=new Date,e()});let a=n.models.Company||(0,n.model)("Company",o)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[638,206],()=>r(13046));module.exports=n})();