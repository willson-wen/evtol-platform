"use strict";(()=>{var e={};e.id=654,e.ids=[654],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},47753:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>f,originalPathname:()=>y,patchFetch:()=>v,requestAsyncStorage:()=>g,routeModule:()=>c,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>w});var r={};a.r(r),a.d(r,{POST:()=>l});var n=a(95419),s=a(69108),o=a(99678),i=a(78070),u=a(6521),p=a(22345),d=a(52055);async function l(e){try{let{name:t,email:a,password:r}=await e.json();if(!t)return i.Z.json({message:"请输入用户名"},{status:400});if(!a)return i.Z.json({message:"请输入邮箱地址"},{status:400});if(!r)return i.Z.json({message:"请输入密码"},{status:400});if(await (0,p.u)(),await d.Z.findOne({email:a}))return i.Z.json({message:"该邮箱已被注册"},{status:400});if(await d.Z.findOne({name:t}))return i.Z.json({message:"该用户名已被使用"},{status:400});let n=await (0,u.hash)(r,12),s=await d.Z.create({name:t,email:a,password:n});return i.Z.json({message:"注册成功",user:{id:s._id,name:s.name,email:s.email}},{status:201})}catch(e){return console.error("注册失败:",e),i.Z.json({message:e.message||"注册过程中发生错误"},{status:500})}}let c=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/signup/route",pathname:"/api/auth/signup",filename:"route",bundlePath:"app/api/auth/signup/route"},resolvedPagePath:"C:\\Users\\Lenovo\\Desktop\\低空网站原始\\app\\api\\auth\\signup\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:h,headerHooks:f,staticGenerationBailout:w}=c,y="/api/auth/signup/route";function v(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},22345:(e,t,a)=>{a.d(t,{u:()=>i});var r=a(11185),n=a.n(r);let s=process.env.MONGODB_URI;if(!s)throw Error("请在环境变量中设置 MONGODB_URI");let o=!1;async function i(){if(o){console.log("已连接到 MongoDB");return}try{let e=await n().connect(s);o=1===e.connections[0].readyState,console.log("MongoDB 连接成功")}catch(e){throw console.error("MongoDB 连接失败:",e),e}}},52055:(e,t,a)=>{a.d(t,{Z:()=>s});var r=a(11185);let n=new r.Schema({name:{type:String,required:[!0,"请输入用户名"]},email:{type:String,required:[!0,"请输入邮箱"],unique:!0,lowercase:!0,trim:!0},password:{type:String,required:[!0,"请输入密码"],minlength:[6,"密码至少6个字符"]},role:{type:String,enum:["user","admin"],default:"user"},avatar:{type:String,default:""},company:{type:String,default:""},position:{type:String,default:""},createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}});n.pre("save",function(e){this.updatedAt=new Date,e()});let s=r.models.User||(0,r.model)("User",n)}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[638,206,521],()=>a(47753));module.exports=r})();